<!DOCTYPE html>
<html lang="en"><head>
<script src="pres_files/libs/clipboard/clipboard.min.js"></script>
<script src="pres_files/libs/quarto-html/tabby.min.js"></script>
<script src="pres_files/libs/quarto-html/popper.min.js"></script>
<script src="pres_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="pres_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="pres_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="pres_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <title>Presentacion</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="pres_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="pres_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="pres_files/libs/revealjs/dist/theme/quarto-cea50a97bd1bf62732e69dd56e0c8687.css">
  <link rel="stylesheet" href="ine_quarto_style_v2025_v2.css">
  <link href="pres_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="pres_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="pres_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="pres_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="portada" class="slide level2 portada">
<h2></h2>
<div class="logo-box">
<p><img src="imagenes/logo_portada3.png"></p>
</div>
<div class="title-area">
<h1>
Monitoreo de Modelos de Clasificación de Texto
</h1>
<h2>
Unidad de Gobierno de Datos
</h2>
<p>
<strong>Octubre 2025</strong>
</p>
</div>
</section>
<section id="contenidos" class="slide level2">
<h2><span class="big-par">Contenidos</span></h2>
<!-- ::: {.incremental} -->
<ul>
<li><p>Motivación hacia el Monitoreo</p></li>
<li><p>Model monitoring</p>
<ul>
<li><p>Architecture</p></li>
<li><p>Metrics</p>
<ul>
<li><p>Definition</p></li>
<li><p>Validation</p></li>
<li><p>Results</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="motivación-hacia-el-monitoreo-i" class="slide level2">
<h2><span class="big-par">Motivación hacia el Monitoreo I</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>La Encuesta Nacional de Empleo (ENE)</strong> genera mes a mes glosas abiertas que deben ser clasificadas y que dan cuenta de las ocupaciones y actividad económica del mercado laboral del país.</li>
<li class="fragment">En su flujo de procesamiento, analistas de la ENE utilizan <strong>codificación automática</strong> para clasificar la ocupación (CIUO) y la rama de actividad económica (CAENES) de las personas, al nivel de desagregación de 1 y 2 dígitos.</li>
<li class="fragment">Cuatro <strong>modelos de machine learning</strong> han sido disponibilizados desde Ciencia de Datos para colaborar en esta tarea:
<ul>
<li class="fragment"><strong>Modelo CIUO a 1 y 2 dígitos.</strong></li>
<li class="fragment"><strong>Modelo CAENES a 1 y 2 dígitos.</strong></li>
</ul></li>
<li class="fragment">Además de la ENE, otras instituciones públicas también usan estos modelos (MDSF, ChileCompra, DT, FNE).</li>
</ul>
</div>
</section>
<section id="motivación-hacia-el-monitoreo-ii" class="slide level2">
<h2><span class="big-par">Motivación hacia el Monitoreo II</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Los modelos de machine learning se degradan con el tiempo</strong>, ya que deben lidiar con varios problemas: casos extremos, bucles de retroalimentación positiva y cambios en la distribución de los datos (<em>data drift</em>).</li>
<li class="fragment"><em>Data drift</em> puede ocurrir debido a errores de código en el procesamiento, variaciones en el esquema de datos de entrada, <strong>cambios en las distribuciones de características (<em>features</em>)</strong> o <strong>cambios en las condiciones del mundo real con el tiempo</strong>.</li>
</ul>
</div>
<div class="r-stack center" data-fragment-index="2">
<p><img data-src="imagenes/monitoring/data_distribution_shifts.png" class="fragment" style="width:100.0%"></p>
</div>
</section>
<section id="motivación-hacia-el-monitoreo-ii-1" class="slide level2">
<h2><span class="big-par">Motivación hacia el Monitoreo II</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><em>Data drift</em>: <strong>¿cómo se presenta en el tiempo?</strong></li>
</ul>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/data_drift_evolution_type.png" class="fragment quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</section>
<section id="motivación-hacia-el-monitoreo-ii-2" class="slide level2">
<h2><span class="big-par">Motivación hacia el Monitoreo II</span></h2>
<div class="medium-par">
<ul>
<li class="fragment">Solución: <strong>monitoreo periódico y re-entrenamiento de los modelos</strong>.
<ul>
<li class="fragment">En el caso de la ENE, mes a mes analistas nos envían las glosas de ocupación y actividad económica correspondientes a los datos de la coyuntura mensual.</li>
<li class="fragment">Hacemos uso de estas glosas para implementar el monitoreo: <strong>comparando el nuevo dataset mensual (producción) versus el usado para entrenar los modelos (referencia)</strong>, evaluando la existencia de <strong>data drift</strong>.</li>
</ul></li>
</ul>
</div>
</section>
<section id="model-monitoring-architecture" class="slide level2">
<h2><span class="big-par">Model monitoring | Architecture</span></h2>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_05.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_06.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</section>
<section id="model-monitoring-metrics-definition" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Definition</span></h2>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_stages_03.png" class="fragment quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Comparamos los dataset de producción (coyuntura) y de referencia (entrenamiento) aplicando múltiples métricas de drift</strong>:
<ul>
<li class="fragment">Algunas implementadas por la librería open-source <a href="https://docs.evidentlyai.com/metrics/customize_data_drift">Evidently</a>.
<ul>
<li class="fragment">a nivel de cada clase (predicción / ground truth) y dataset.</li>
</ul></li>
<li class="fragment">Otras implementadas a medida, como proxy para estimar la incerteza y novedad de los registros.
<ul>
<li class="fragment">a nivel de cada registro.</li>
</ul></li>
</ul></li>
<li class="fragment"><strong>Combinando las diferentes métricas obtenidas, calculamos una métrica única</strong>.
<ul>
<li class="fragment">nos permite seleccionar un subconjunto de registros para ser enviado a revisión.</li>
</ul></li>
<li class="fragment">Las diferentes métricas calculadas se almacenan en <strong>MinIO</strong> como archivos <strong>html, json, parquet</strong>.</li>
</ul>
</div>
</section>
<section id="model-monitoring-metrics-definition-1" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Definition</span></h2>
<!-- ::: {.small-par}

| Test / Report                      | Evaluación | Nivel |
|:-----------------------------------|:------------|:------------|
| Test Suite                         | checks generales sobre columnas **oficio, tareas y actividad **(sólo CAENES)      |  dataset    |
| Report Text Summary                | estadísticas generales (mean, std, etc.) sobre los descriptores **Text Length** y **Word Count** aplicados sobre las columnas **oficio, tareas y actividad **(sólo CAENES). | dataset |
| Report Text Drift                  | drift sobre los descriptores **Text Length** y **Word Count** aplicados a las columnas **oficio, tareas y actividad** (sólo CAENES). <br> - **Text Length**: largo del texto en caracteres. <br>  - **Word Count**: número de palabras en el texto. | clase + dataset |
| Report Embedding Drift             | drift en los **embeddings obtenidos para el dataset de producción y referencia**, a partir de los mismos word embeddings pre-entrenados usados en el entrenamiento del modelo. |  clase + dataset |
| Report Prediction Drift            | drift en las **clases predichas por del modelo**. | dataset |
| Report Prediction Drift vs Truth   | drift en las **clases predichas por del modelo en el dataset de producción** vs **classes verdaderas en el dataset de referencia**. | dataset |
| Report Prediction Class Prob Drift | drift en las **probabilidades de las clases predichas por del modelo**. |  clase + dataset |
| Report Drift Priority | priority score basado en **incerteza y novedad de las glosas**. | registro |
: {tbl-colwidths="[25,55,20]"}

::: -->
<div class="medium-par">
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 55%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Report</th>
<th style="text-align: left;">Evaluación</th>
<th style="text-align: left;">Nivel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Text Drift</td>
<td style="text-align: left;">drift sobre los descriptores <strong>Text Length</strong> y <strong>Word Count</strong> aplicados a las columnas <strong>oficio, tareas y actividad</strong> (sólo CAENES). <br> - <strong>Text Length</strong>: largo del texto en caracteres. <br> - <strong>Word Count</strong>: número de palabras en el texto.</td>
<td style="text-align: left;">clase, dataset</td>
</tr>
<tr class="even">
<td style="text-align: left;">Embedding Drift</td>
<td style="text-align: left;">drift en los <strong>embeddings obtenidos para el dataset de producción y referencia</strong>, a partir de los mismos word embeddings pre-entrenados usados en el entrenamiento del modelo.</td>
<td style="text-align: left;">clase, dataset</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Prediction Drift</td>
<td style="text-align: left;">drift en las <strong>clases predichas por el modelo</strong>.</td>
<td style="text-align: left;">dataset</td>
</tr>
<tr class="even">
<td style="text-align: left;">Prediction Drift vs Truth</td>
<td style="text-align: left;">drift en las <strong>clases predichas por el modelo en el dataset de producción</strong> vs <strong>classes verdaderas en el dataset de referencia</strong>.</td>
<td style="text-align: left;">dataset</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Prediction Class Prob Drift</td>
<td style="text-align: left;">drift en las <strong>probabilidades de las clases predichas por el modelo</strong>.</td>
<td style="text-align: left;">clase, dataset</td>
</tr>
<tr class="even">
<td style="text-align: left;">Record Drift</td>
<td style="text-align: left;">drift basado en <strong>incerteza y novedad de las glosas</strong>.</td>
<td style="text-align: left;">registro</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="model-monitoring-metrics-definition-2" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Definition</span></h2>
<div class="medium-par">
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 50%">
<col style="width: 10%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Report</th>
<th style="text-align: left;">Métrica para evaluar drift</th>
<th style="text-align: left;">Rango</th>
<th style="text-align: left;">Threshold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Text Drift</td>
<td style="text-align: left;">- <strong>Wasserstein distance</strong>: modelos a 1 dígito. <br> - <strong>Kolmogorov–Smirnov (K-S) test</strong>: modelos a 2 dígitos.</td>
<td style="text-align: left;">[0, +inf] <br> [0, 1]</td>
<td style="text-align: left;">drift ≥ 0.1 <br> drift &lt; 0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">Embedding Drift</td>
<td style="text-align: left;">- <strong>Binary classifier</strong> para distinguir entre los embeddings calculados desde ambos datasets. <br> - Retorna valores de <strong>ROC AUC como <em>drift_score</em></strong>.</td>
<td style="text-align: left;">[0, 1]</td>
<td style="text-align: left;">drift &gt; 0.55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Prediction Drift</td>
<td style="text-align: left;">- <strong>Jensen-Shannon distance</strong>.</td>
<td style="text-align: left;">[0, 1]</td>
<td style="text-align: left;">drift ≥ 0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Prediction Drift vs Truth</td>
<td style="text-align: left;">- <strong>Jensen-Shannon distance</strong>.</td>
<td style="text-align: left;">[0, 1]</td>
<td style="text-align: left;">drift ≥ 0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Prediction Class Prob Drift</td>
<td style="text-align: left;">- <strong>Wasserstein distance</strong>: modelos a 1 dígito. <br> - <strong>Kolmogorov–Smirnov (K-S) test</strong>: modelos a 2 dígitos.</td>
<td style="text-align: left;">[0, +inf] <br> [0, 1]</td>
<td style="text-align: left;">drift ≥ 0.1 <br> drift &lt; 0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">Record Drift</td>
<td style="text-align: left;">- uncertainty_score_norm <br> - novelty_score_norm</td>
<td style="text-align: left;">[0, 1] <br> [0, 1]</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="model-monitoring-metrics-definition-3" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Definition</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Cómo calculamos una única métrica a partir de las múltiples métricas aplicadas?</strong>
<ul>
<li class="fragment">Usamos sumas ponderadas para combinar las métricas obtenidas a distintos niveles (registro, clase, dataset) y luego para obtener una métrica final de revisión.</li>
</ul></li>
<li class="fragment"><strong>Record drift score:</strong>
<ul>
<li class="fragment">Suma ponderada de métricas a nivel de registro: <br> uncertainty_score_norm, novelty_score_norm.</li>
</ul></li>
<li class="fragment"><strong>Class drift score:</strong>
<ul>
<li class="fragment">Suma ponderada de métricas a nivel de clase y dataset normalizadas (entre 0 y 1): <br> drift en descriptores de texto, embeddings, clases predichas, clases predichas vs verdaderas, probabilidades de las clases predichas.</li>
</ul></li>
<li class="fragment"><strong>Revision score:</strong>
<ul>
<li class="fragment">Suma ponderada de <strong>record_drift_score</strong> y <strong>class_drift_score</strong>.</li>
<li class="fragment">Nos permite seleccionar qué registros del periodo analizado (coyuntura) es importante revisar.</li>
</ul></li>
</ul>
</div>
</section>
<section id="model-monitoring-metrics-definition-4" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Definition</span></h2>
<div class="medium-par">
<table class="caption-top">
<colgroup>
<col style="width: 52%">
<col style="width: 8%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">W</th>
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">W</th>
<th style="text-align: left;">Metric</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">uncertainty_score_norm <br> novelty_score_norm</td>
<td style="text-align: left;">0.5 <br> 0.5</td>
<td style="text-align: left;"><br> <strong>record_drift_score</strong></td>
<td style="text-align: left;"><br> 0.5</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">delta_drift_score_length_oficio_class_norm <br> delta_drift_score_length_tareas_class_norm <br> delta_drift_score_wordcount_oficio_class_norm <br> delta_drift_score_wordcount_tareas_class_norm <br> delta_drift_score_small_embeddings_class_norm <br> delta_drift_score_big_embeddings_class_norm <br> delta_drift_score_prediction_class_probs_class_norm <br> delta_drift_score_length_oficio_global_norm <br> delta_drift_score_length_tareas_global_norm <br> delta_drift_score_wordcount_oficio_global_norm <br> delta_drift_score_wordcount_tareas_global_norm <br> delta_drift_score_small_embeddings_global_norm <br> delta_drift_score_big_embeddings_global_norm <br> delta_drift_score_prediction_global_norm <br> delta_drift_score_prediction_vs_truth_global_norm <br> delta_drift_score_prediction_class_probs_global_norm</td>
<td style="text-align: left;">0.08 <br> 0.08 <br> 0.08 <br> 0.08 <br> 0.08 <br> 0.08 <br> 0.08 <br> 0.04 <br> 0.04 <br> 0.04 <br> 0.04 <br> 0.04 <br> 0.04 <br> 0.04 <br> 0.04 <br> 0.04</td>
<td style="text-align: left;"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br> <strong>class_drift_score</strong></td>
<td style="text-align: left;"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br> 0.5</td>
<td style="text-align: left;"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br> <strong>revision_score</strong></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="model-monitoring-metrics-validation" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Validation</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>¿Cómo validamos las métricas calculadas?</strong>
<ul>
<li class="fragment">Seleccionamos un subconjunto de registros para cada periodo de interés (ej: coyunturas) para ser codificado por analistas expertos a uno y dos dígitos.
<ul>
<li class="fragment">100 registros para cada tipo de modelo: CIUO y CAENES.</li>
<li class="fragment">Cada selección contiene registros observados en los valores más bajos (<em>smaller</em>) y altos (<em>larger</em>) del <strong>revision_score</strong> en el periodo, ordenados aleatoriamente.</li>
<li class="fragment">Distribución de clases (predichas) es la misma que en el dataset de producción del periodo.</li>
</ul></li>
<li class="fragment">Dos analistas clasificarán el mismo subconjunto de registros seleccionados.
<ul>
<li class="fragment">Permite contar con dos clasificaciones independientes y contrastarlas.</li>
</ul></li>
<li class="fragment">Los analistas además responderían un par de preguntas que nos permitirán evaluar la <strong>complejidad</strong> y <strong>novedad</strong> de los registros, a partir de su conocimiento experto.
<ul>
<li class="fragment"><strong>Q1. En relación a lo complejo que usualmente le es codificar un registro, ¿qué tan difícil fue clasificar este registro a dos dígitos?:</strong>
<ul>
<li class="fragment">1: Fue fácil.</li>
<li class="fragment">2: Fue medianamente difícil.</li>
<li class="fragment">3: Fue difícil.</li>
</ul></li>
<li class="fragment"><strong>Q2. ¿Considerando su experiencia codificando, qué tan parecido considera este registro a alguno que haya visto en el pasado?</strong>
<ul>
<li class="fragment">1: Es parecido. He visto bastantes glosas similares en el pasado.</li>
<li class="fragment">2: Algo parecido. He visto algunas glosas similares en el pasado.</li>
<li class="fragment">3: Es distinto. He visto muy pocas o ninguna glosa similar en el pasado.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="model-monitoring-metrics-validation-1" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Validation</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Cómo validamos las métricas calculadas?</strong>
<ul>
<li class="fragment">Validación de métricas:
<ul>
<li class="fragment">Analizaremos cómo se correlacionan nuestras métricas con:
<ul>
<li class="fragment">La estimación de complejidad y novedad de los analistas.</li>
<li class="fragment">La clasificación realizada por los analistas.</li>
<li class="fragment">Análisis para una coyuntura hasta ahora: 2024-01.</li>
</ul></li>
<li class="fragment"><em>Evaluaremos cómo evoluciona en el tiempo la performance de los modelos en base a la clasificación realizada por analistas.</em>
<ul>
<li class="fragment"><em>A partir de dicha evaluación, podremos estimar la frecuencia con que sería conveniente re-entrenar los modelos.</em></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="model-monitoring-metrics-results-questions-to-analysts" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Questions to analysts</span></h2>
<div class="medium-par">
<p><strong>Q1: … ¿qué tan difícil fue clasificar este registro a dos dígitos? </strong> <br><br> <strong>Q2: … ¿qué tan parecido considera este registro a alguno que haya visto en el pasado? </strong></p>
</div>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/results_qs_answers_vs_revision_score_01.png" class="quarto-figure quarto-figure-center" style="width:70.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-questions-to-analysts-1" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Questions to analysts</span></h2>
<p>question = Q1, model = ciuo</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/results_qs_answers_vs_revision_score_02.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-questions-to-analysts-2" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Questions to analysts</span></h2>
<p>question = Q1, model = caenes</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/results_qs_answers_vs_revision_score_04.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-questions-to-analysts-3" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Questions to analysts</span></h2>
<p>question = Q2, model = ciuo</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/results_qs_answers_vs_revision_score_03.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-questions-to-analysts-4" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Questions to analysts</span></h2>
<p>question = Q2, model = caenes</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/results_qs_answers_vs_revision_score_05.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-questions-to-analysts-5" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Questions to analysts</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Correlación entre nuestras métricas y estimación de complejidad (Q1) y novedad de los analistas (Q2).</strong>
<ul>
<li class="fragment">Q1: Tanto para modelo CIUO como CAENES, vemos en la región de <strong>revision_score</strong>:
<ul>
<li class="fragment">menor, registros en su gran mayoría fáciles de clasificar (86-98%) y muy pocos díficiles de clasificar (0-8%) para analistas.</li>
<li class="fragment">mayor, aumento en la proporción de registros díficiles de clasificar (12-34%) y disminución en registros fáciles de clasificar (40-76%) para analistas.</li>
</ul></li>
<li class="fragment">Q2: Tanto para el modelo CIUO como CAENES, vemos en la región de <strong>revision_score</strong>:
<ul>
<li class="fragment">menor, registros que tienden a ser más <em>parecidos</em> (70-98%) comparado con los <em>algo parecidos</em> (2-30%) o <em>distintos</em> (0-8%) para analistas.</li>
<li class="fragment">mayor, aumento tanto de registros <em>distintos</em> (10-34%) como <em>algo parecidos</em> (16-62%) y disminución de registros <em>parecidos</em> (14-74%) para analistas.</li>
</ul></li>
<li class="fragment"><strong>Menor evidencia de drift en registros se correlaciona con menor complejidad y novedad para analistas. ✅</strong></li>
<li class="fragment"><strong>Mayor evidencia de drift en registros se correlaciona parcialmente con mayor complejidad y novedad para analistas. ✅</strong></li>
</ul></li>
</ul>
</div>
<p><br></p>
<div class="medium-par">
<table class="caption-top" style="width:85%;">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Q</th>
<th style="text-align: left;">model</th>
<th style="text-align: left;">revision_score</th>
<th style="text-align: left;">codificador_1 (R1, R2, R3)</th>
<th style="text-align: left;">codificador_2 (R1, R2, R3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Q1</td>
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">(46, 4, 0) &nbsp; = <strong>(92, 8, 0) %</strong></td>
<td style="text-align: left;">(49, 1, 0) &nbsp; &nbsp; = <strong>(98, 2, 0) %</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Q1</td>
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">(26, 18, 6) = <strong>(52, 36, 12) %</strong></td>
<td style="text-align: left;">(27, 14, 9) &nbsp; = <strong>(54, 28, 18) %</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q1</td>
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">(49, 1, 0) &nbsp; = <strong>(98, 2, 0) %</strong></td>
<td style="text-align: left;">(43, 3, 4) &nbsp; &nbsp; = <strong>(86, 6, 8) %</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Q1</td>
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">(38, 5, 7) &nbsp; = <strong>(76, 10, 14) %</strong></td>
<td style="text-align: left;">(20, 8, 17) &nbsp; = <strong>(40, 16, 34) %</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q2</td>
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">(35, 15, 0) = <strong>(70, 30, 0) %</strong></td>
<td style="text-align: left;">(49, 1, 0) &nbsp; &nbsp; = <strong>(98, 2, 0) %</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Q2</td>
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">(7, 31, 12) = <strong>(14, 62, 24) %</strong></td>
<td style="text-align: left;">(22, 20, 8) &nbsp; = <strong>(44, 40, 16) %</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q2</td>
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">(49, 1, 0) &nbsp; = <strong>(98, 2, 0) %</strong></td>
<td style="text-align: left;">(44, 2, 4) &nbsp; &nbsp; = <strong>(88, 4, 8) %</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Q2</td>
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">(37, 8, 5) &nbsp; = <strong>(74, 16, 10) %</strong></td>
<td style="text-align: left;">(20, 8, 17) &nbsp; = <strong>(40, 16, 34) %</strong></td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/results_qs_answers_vs_revision_score_01.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = ciuo, revision_score = smaller, codificador 1. Acc = 0.98</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_ciuo_202401_revision_score_smallest_codificador_1.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-1" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = ciuo, revision_score = smaller, codificador 2. Acc = 1.0</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_ciuo_202401_revision_score_smallest_codificador_2.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-2" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = ciuo, revision_score = smaller, codificador 1 vs 2. Acc = 0.98</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_ciuo_202401_revision_score_smallest_codificador_1_vs_2.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-3" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = ciuo, revision_score = larger, codificador 1. Acc = 0.30</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_ciuo_202401_revision_score_largest_codificador_1.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-4" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = ciuo, revision_score = larger, codificador 2. Acc = 0.28</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_ciuo_202401_revision_score_largest_codificador_2.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-5" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = ciuo, revision_score = larger, codificador 1 vs 2. Acc = 0.74</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_ciuo_202401_revision_score_largest_codificador_1_vs_2.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-6" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = caenes, revision_score = smaller, codificador 1. Acc = 0.92</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_caenes_202401_revision_score_smallest_codificador_1.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-7" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = caenes, revision_score = smaller, codificador 2. Acc = 0.94</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_caenes_202401_revision_score_smallest_codificador_2.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-8" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = caenes, revision_score = smaller, codificador 1 vs 2. Acc = 0.94</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_caenes_202401_revision_score_smallest_codificador_1_vs_2.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-9" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = caenes, revision_score = larger, codificador 1. Acc = 0.12</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_caenes_202401_revision_score_largest_codificador_1.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-10" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = caenes, revision_score = larger, codificador 2. Acc = 0.12</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_caenes_202401_revision_score_largest_codificador_2.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-11" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<p>model = caenes, revision_score = larger, codificador 1 vs 2. Acc = 0.70</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/results/confusion_matrix_model_caenes_202401_revision_score_largest_codificador_1_vs_2.png" class="quarto-figure quarto-figure-center" style="width:55.0%"></p>
</figure>
</div>
</section>
<section id="model-monitoring-metrics-results-analysts-vs-model-12" class="slide level2">
<h2><span class="big-par">Model monitoring | Metrics | Results: Analysts vs Model</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Correlación entre nuestras métricas y clasificación realizada por los analistas.</strong>
<ul>
<li class="fragment">Se observa un <em>accuracy</em> alto en la región de menor revision_score tanto para el modelo CIUO (0.98 - 1.0) como CAENES (0.92 - 0.94), con una alta concordancia entre clasificadores en ambos casos (0.98 y 0.94, respectivamente).</li>
<li class="fragment">El <em>accuracy</em> decae drásticamente en la región de mayor revision_score tanto para el modelo CIUO (0.28 - 0.30) como CAENES (0.12), con una concordancia entre clasificadores que decae en menor medida (0.74 y 0.70, respectivamente).</li>
<li class="fragment"><strong>Evidencia de drift se relaciona inversamente con la performance de los modelos e incluso con la concordancia entre analistas. ✅</strong></li>
</ul></li>
</ul>
</div>
<div class="medium-par">
<table class="caption-top">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 35%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">revision_score</th>
<th style="text-align: left;">test</th>
<th style="text-align: left;">accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">codificador 1 vs model</td>
<td style="text-align: left;">0.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">codificador 2 vs model</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">codificador 1 vs 2</td>
<td style="text-align: left;">0.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">codificador 1 vs model</td>
<td style="text-align: left;">0.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">codificador 2 vs model</td>
<td style="text-align: left;">0.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">ciuo</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">codificador 1 vs 2</td>
<td style="text-align: left;">0.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">codificador 1 vs model</td>
<td style="text-align: left;">0.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">codificador 2 vs model</td>
<td style="text-align: left;">0.94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">smaller</td>
<td style="text-align: left;">codificador 1 vs 2</td>
<td style="text-align: left;">0.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">codificador 1 vs model</td>
<td style="text-align: left;">0.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">codificador 2 vs model</td>
<td style="text-align: left;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">caenes</td>
<td style="text-align: left;">larger</td>
<td style="text-align: left;">codificador 1 vs 2</td>
<td style="text-align: left;">0.70</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
</section>
<section id="cierre" class="slide level2 portada">
<h2></h2>
<div class="logo-box">
<p><img src="imagenes/logo_portada3.png" class="portada-logo" alt="Logo"></p>
</div>
<div class="title-area">
<h1>
Monitoreo de Modelos de Clasificación de Texto
</h1>
<h2>
Unidad de Gobierno de Datos
</h2>
<p>
<strong>Octubre 2025</strong>
</p>
</div>
</section>
<section id="apéndice-motivación-hacia-el-monitoreo-ii" class="slide level2">
<h2><span class="big-par">Apéndice | Motivación hacia el Monitoreo II</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Los modelos de machine learning se degradan con el tiempo</strong>, ya que deben lidiar con varios problemas: casos extremos, bucles de retroalimentación positiva y cambios en la distribución de los datos (<em>data drift</em>).
<ul>
<li class="fragment"><strong>Casos extremos</strong> (<em>edge cases</em>): Son muestras válidas pero atípicas que exponen las debilidades de un modelo en producción, llevándolo a hacer predicciones absurdas o catastróficas. <!-- - Son inevitables, pero podemos mitigar su impacto identificando valores atípicos (outliers), diseñando estrategias de contingencia (fallback) y realizando reentrenamientos frecuentes que incluyan estos casos. --></li>
<li class="fragment"><strong>Bucles de retroalimentación positiva</strong> (<em>positive feedback loops</em>): Ocurren cuando las predicciones del modelo influyen en los datos futuros de manera que refuerzan su comportamiento, lo que puede generar resultados sesgados.</li>
<li class="fragment"><strong>Cambios en la distribución</strong> (<em>data drift</em>) ocurren cuando los datos en producción difieren de los datos de entrenamiento utilizados para construir el modelo.</li>
</ul></li>
<li class="fragment">Solución: <strong>monitoreo periódico y re-entrenamiento de los modelos</strong>.
<ul>
<li class="fragment">En el caso de la ENE, mes a mes analistas nos envían las glosas de ocupación y actividad económica correspondientes a los datos de la coyuntura mensual.</li>
<li class="fragment">Hacemos uso de estas glosas para implementar el monitoreo: <strong>comparando el nuevo dataset mensual (producción) versus el usado para entrenar los modelos (referencia)</strong>, evaluando la existencia de <strong>data drift</strong>.</li>
</ul></li>
</ul>
</div>
</section>
<section id="apéndice-data-drift-principales-tipos" class="slide level2">
<h2><span class="big-par">Apéndice | Data drift | Principales tipos</span></h2>
<div class="center" data-fragment-index="0">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/data_distribution_shifts_types.png" class="fragment quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Deriva de covariables</strong> (<em>Covariate drift</em>): Ocurre cuando la distribución de las variables de entrada cambia, pero la relación entre estas características y la variable objetivo se mantiene igual.
<ul>
<li class="fragment">Cambia la forma en que se describen ocupaciones/actividades (lenguaje en las glosas), pero el significado final (etiqueta) se mantiene.</li>
<li class="fragment">Ej: aparecen nuevas palabras como programar, diseñar, gestionar en línea, pero esas descripciones siguen correspondiendo a la misma categoría de ocupación (ej: “Ingeniero de software”).</li>
</ul></li>
</ul>
</div>
</section>
<section id="apéndice-data-drift-principales-tipos-1" class="slide level2">
<h2><span class="big-par">Apéndice | Data drift | Principales tipos</span></h2>
<div class="center" data-fragment-index="0">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/data_distribution_shifts_types.png" class="fragment quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Deriva de etiquetas</strong> (<em>Label drift</em>): Sucede cuando la distribución de la variable objetivo cambia, mientras que la relación entre las características de entrada y la variable objetivo permanece constante.
<ul>
<li class="fragment">Cambian las frecuencias relativas de clases (qué ocupaciones/actividades son más comunes), aunque la correspondencia entrada → salida se mantiene.</li>
<li class="fragment">Ej: aunque las descripciones de los registros se mantengan estables, cada vez aparecen más casos etiquetados como ocupaciones de “Tecnología” y menos de “Administración”.</li>
</ul></li>
</ul>
</div>
</section>
<section id="apéndice-data-drift-principales-tipos-2" class="slide level2">
<h2><span class="big-par">Apéndice | Data drift | Principales tipos</span></h2>
<div class="center" data-fragment-index="0">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/data_distribution_shifts_types.png" class="fragment quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</div>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Deriva de concepto</strong> (<em>Concept drift</em>): Se produce cuando la relación entre las características de entrada y la variable objetivo varía debido a que los supuestos del modelo ya no son válidos.
<ul>
<li class="fragment">cambia la relación entrada → salida, porque los términos empiezan a usarse para otros conceptos.</li>
<li class="fragment">Ej: si se decide que una palabra que estaba asociada a la clase X comienza a asociarse a la clase Y.</li>
</ul></li>
</ul>
</div>
</section>
<section id="apéndice-esquema-general" class="slide level2">
<h2><span class="big-par">Apéndice | Esquema General</span></h2>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_01.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_02.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_03.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</section>
<section id="apéndice-model-training" class="slide level2">
<h2><span class="big-par">Apéndice | Model training</span></h2>
<div class="medium-par">
<ul>
<li class="fragment">Los modelos disponibilizados fueron entrenados en Pytorch utilizando una arquitectura <strong>RNN: multi-layer gated recurrent unit (GRU)</strong>.</li>
<li class="fragment">Para mejorar el aprendizaje del modelo, se agregó una capa preliminar que incluye <a href="https://github.com/dccuchile/spanish-word-embeddings/">word embeddings</a> pre-entrenados.
<ul>
<li class="fragment">Los embeddings son representaciones de palabras como vectores numéricos, que permiten modelar la relación semántica entre palabras.</li>
<li class="fragment">Los embeddings capturan la relación entre palabras en las glosas de entrenamiento, lo que aumenta la capacidad de aprendizaje del modelo. <!-- - Modelo disponibilizado a través de una API creada en FastAPI. --></li>
</ul></li>
<li class="fragment">Métricas obtenidas:</li>
</ul>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/trained_models_metrics.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</section>
<section id="apéndice-model-prediction" class="slide level2">
<h2><span class="big-par">Apéndice | Model prediction</span></h2>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_04.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</section>
<section id="apéndice-model-prediction-1" class="slide level2">
<h2><span class="big-par">Apéndice | Model prediction</span></h2>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_model_prediction.png" class="fragment quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/api_clasificador_01.png" class="fragment quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/api_clasificador_02.png" class="fragment quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-data-capture" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Data capture</span></h2>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_stages_01.png" class="fragment quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/db_data_capture_reference_01.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/db_data_capture_reference_02.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-data-capture-1" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Data capture</span></h2>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_stages_02.png" class="fragment quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/db_data_capture_production_01.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/db_data_capture_production_02.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-dashboard" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Dashboard</span></h2>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/monitoring_pipeline_stages_04.png" class="fragment quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/dashboard_monitoreo_02.png" class="fragment quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="fragment">
<div class="center">
<p><a href="http://10.90.10.60:8050/">Veamos el dashboard</a></p>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-metrics" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>1) Wasserstein distance</strong>:</li>
<li class="fragment">La usamos en <strong>Text Drift</strong> y <strong>Prediction Class Prob Drift</strong>, para modelos a 1 dígitos.</li>
<li class="fragment">Mide la distancia entre dos distribuciones de probabilidad, calculando la cantidad mínima de <em>trabajo</em> requerido para transformar una distribución en otra.
<ul>
<li class="fragment"><em>Trabajo</em> se refiere al costo de mover una unidad de masa de probabilidad.</li>
<li class="fragment"><em>drift_score</em> en rango [0, +inf]:
<ul>
<li class="fragment">0 indica que las dos distribuciones son idénticas.</li>
<li class="fragment"><em>&gt; threshold</em> es indicativo de drift. Por defecto <em>threshold = 0.1</em></li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-1" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>1) Wasserstein distance</strong>: estimación.</li>
</ul>
</div>
<div class="r-stack quarto-layout-panel" data-fragment-index="2" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 46.2%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/wasserstein_distance_estimation_01.png" class="fragment quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 53.8%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/wasserstein_distance_estimation_02.png" class="fragment quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-2" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>2) Kolmogorov–Smirnov (K-S) test</strong>:</li>
<li class="fragment">La usamos en <strong>Text Drift</strong> y <strong>Prediction Class Prob Drift</strong>, para modelos a 2 dígitos.</li>
<li class="fragment">Es una prueba estadística no paramétrica: no asume una distribución específica de los datos (ejemplo: normal u otra).
<ul>
<li class="fragment">Construye distribuciones de probabilidad acumulada (CDFs).</li>
<li class="fragment">Evalúa la máxima diferencia absoluta entre ambas CDFs y ese valor se usa como estadístico de prueba.</li>
<li class="fragment">La hipótesis nula es que las dos muestras vienen de la misma distribución y la prueba se aplica para rechazar o aceptar esta hipótesis.</li>
<li class="fragment">Retorna <em>p_value</em> en rango [0, 1].
<ul>
<li class="fragment">Si <em>p_value &lt; 0.05</em>, usualmente podemos declarar que hay evidencia para rechazar la hipótesis nula y considerar que las dos muestras son diferentes, es decir, que existe drift.</li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-3" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>2) Kolmogorov–Smirnov (K-S) test</strong>: estimación.</li>
</ul>
</div>
<div class="r-stack quarto-layout-panel" data-fragment-index="2" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 45.5%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/kolmogorov_smirnov_test_estimation_01.png" class="fragment quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 54.5%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/kolmogorov_smirnov_test_estimation_02.png" class="fragment quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-4" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>3) Jensen-Shannon distance</strong>:</li>
<li class="fragment">La usamos en <strong>Prediction Drift</strong> y <strong>Prediction Drift vs Truth</strong>, para modelos a 1 y 2 dígitos.</li>
<li class="fragment">Basada en el método <strong>Kullback-Leibler Divergence</strong>, mide la distancia entre dos distribuciones de probabilidad calculando la raíz cuadrada de la <strong>Jensen-Shannon divergence</strong>.
<ul>
<li class="fragment"><em>drift_score</em> en rango [0, 1]:
<ul>
<li class="fragment">0 indica que las dos distribuciones son idénticas.</li>
<li class="fragment"><em>&gt; threshold</em> es indicativo de data drift. Por defecto <em>threshold = 0.1</em></li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-5" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>3) Jensen-Shannon distance</strong>: estimación.</li>
</ul>
</div>
<div class="r-stack quarto-layout-panel" data-fragment-index="2" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 46.7%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/jensen_shannon_distance_estimation_01.png" class="fragment quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 53.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/jensen_shannon_distance_estimation_02.png" class="fragment quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-6" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>4) Binary Classifier</strong></li>
<li class="fragment">Lo usamos en <strong>Embedding Drift</strong> (modelos a 1 y 2 dígitos).</li>
<li class="fragment">Este clasificador retorna valores de <strong>ROC AUC como <em>drift_score</em></strong>.
<ul>
<li class="fragment"><em>drift_score</em> en rango [0, 1].</li>
<li class="fragment"><em>&gt; threshold</em> es indicativo de data drift. Por defecto <em>threshold = 0.55</em></li>
</ul></li>
</ul>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/drift_embeddings_pres_01.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/drift_embeddings_pres_02.png" class="fragment quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-7" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>4) Binary Classifier</strong>: estimación.</li>
</ul>
</div>
<div class="r-stack center" data-fragment-index="2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/roc_curve_estimation_pres.png" class="fragment fade-in-then-out quarto-figure quarto-figure-center" style="width:80.0%"></p>
</figure>
</div>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-8" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>5) Record Drift:</strong>
<ul>
<li class="fragment"><strong>Uncertainty score:</strong> Es una medida de la baja confianza de los registros del dataset de producción, estimada en base a las probabilidades de predicción del modelo. <span class="math display">\[
\small uncertainty\_score = 1 - prediction\_probability
\]</span></li>
</ul></li>
</ul>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-9" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Novelty score:</strong> Es una medida de la diferencia semántica entre registros del dataset de producción y referencia. <br> Combina similitud coseno y la mínima distancia euclidiana normalizada calculadas para cada embedding del dataset de producción respecto a todos los embeddings del dataset de referencia. <!--   $$ --> <!-- \small novelty\_score = \frac{(1 - max\_cosine\_similarity + min\_euclidean\_distance\_norm)}{2} --> <!-- $$ --></li>
<li class="fragment">Primer paso: calcular la similitud coseno: <span class="math display">\[
  cos\_sim(A, B) = (A · B) / (||A|| × ||B||)
  \]</span> En nuestro caso:
<ul>
<li class="fragment">current_vectors = matriz de M × D (M ejemplos actuales, D dimensiones)</li>
<li class="fragment">reference_vectors = matriz de N × D (N ejemplos de referencia, D dimensiones)</li>
<li class="fragment">cosine_similarity = matriz de M × N donde cada elemento (i,j) es: <span class="math display">\[
similarities[i,j] = cos\_sim(current\_vector[i], reference\_vector[j])
\]</span></li>
</ul></li>
<li class="fragment">Luego, para cada ejemplo actual i, encuentra la similitud más alta con cualquier ejemplo de referencia. <span class="math display">\[
  max\_sim[i] = max(similarities[i,j]) for j ∈ [1, N]
  \]</span></li>
<li class="fragment">Segundo paso: calcular la distancia euclidiana entre los datos actuales y los de referencia: <span class="math display">\[
  euclidean\_dist(A, B) = √[(a₁-b₁)² + (a₂-b₂)² + ... + (aₙ-bₙ)²]
  \]</span></li>
<li class="fragment">Luego, calcular la distancia mínima del ejemplo actual i a cualquier ejemplo de referencia <span class="math display">\[
  min\_dist[i] = min(euclidean\_dist(current[i], reference[j])) for j ∈ [1, N]
  \]</span></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagenes/monitoring/dist_euclidiana.png" class="fragment quarto-figure quarto-figure-center" style="width:30.0%"></p>
</figure>
</div>
<ul>
<li class="fragment">Se normalizan las distancias: <span class="math display">\[
  distance\_score[i] = min\_distances[i] / max(min\_distances)
  \]</span></li>
<li class="fragment">Finalmente definimos el novelty score como el promedio de ambas señales: <span class="math display">\[
  novelty\_score[i] = ((1 - max\_sim[i]) + distance\_score[i]) / 2
  \]</span>
<ul>
<li class="fragment">(1 - max_sim[i]): Qué tan DISimilar es (0 = muy similar, 1 = muy diferente)</li>
<li class="fragment">distance_score[i]: Qué tan lejos está (0 = muy cerca, 1 = muy lejos)</li>
<li class="fragment">En resumen, la similitud coseno detecta cambios semánticos y la distancia euclidiana cambios de intensidad.</li>
<li class="fragment">Los ejemplos con scores altos son candidatos para revisión manual por ser potencialmente nuevos.</li>
</ul></li>
</ul>
<p><!-- - **Diversity score:** Representa la diversidad de los registros en el dataset de producción. Se calcula en base a K-Means clustering, midiendo la distancia de cada registro a su centro de cluster más cercano: 
    1. Aplicar K-Means clustering a los embeddings de los registros de producción.
    2. Para cada registro, calcular distancia euclidiana a su centroide. --></p>
</div>
</section>
<section id="apéndice-model-monitoring-metrics-10" class="slide level2">
<h2><span class="big-par">Apéndice | Model monitoring | Metrics</span></h2>
<div class="medium-par">
<ul>
<li class="fragment"><strong>Record drift score:</strong>
<ul>
<li class="fragment">Se normalizan el novelty score usando la fórmula: <br> <span class="math display">\[
\small
novelty\_score\_norm[i] = \frac{novelty\_score[i] - min(novelty\_score)}{max(novelty\_score) - min(novelty\_score)}
\]</span></li>
<li class="fragment">Luego usamos las métricas normalizadas para calcular: <span class="math display">\[
\small record\_drift_\_score = w_1 \times uncertainty\_score\_norm \\
\small \hspace{4.cm} + w_2 \times novelty\_score\_norm
\]</span></li>
<li class="fragment">donde usamos por defecto los pesos: <span class="math display">\[ \small w_1=0.5, w_2=0.5 \]</span></li>
</ul></li>
</ul>
</div>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="pres_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="pres_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="pres_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="pres_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="pres_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="pres_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="pres_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="pres_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="pres_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="pres_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 2650,

        height: 1550,

        // Factor of the display size that should remain empty around the content
        margin: 0,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>